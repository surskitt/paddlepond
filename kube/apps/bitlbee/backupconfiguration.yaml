---
apiVersion: stash.appscode.com/v1beta1
kind: BackupConfiguration
metadata:
  name: bitlbee
  namespace: bitlbee
spec:
  repository:
    name: bitlbee
  schedule: "30 17 * * *"
  target:
    ref:
      apiVersion: apps/v1
      kind: Deployment
      name: bitlbee
    volumeMounts:
      - name: bitlbee-data
        mountPath: /var/lib/bitlbee
    paths:
      - /var/lib/bitlbee
    exclude:
      - /var/lib/bitlbee/.shane.xml.swo
      - /var/lib/bitlbee/crash.log
      - /var/lib/bitlbee/purple/shane/gowhatsapp
      - /var/lib/bitlbee/purple/shane/logs
  runtimeSettings:
    container:
      securityContext:
        runAsUser: 101
        runAsGroup: 101
  retentionPolicy:
    name: 'keep-last-week'
    keepLast: 7
    prune: true
  timeOut: 5m
